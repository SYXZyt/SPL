const RIGHT 103
const DOWN 25
const RIGHTPOS 102
const DOWNPOS 24
free RIGHT
call init
goto main

:init
	let i 0
	let xsp 1
	let ysp -1
	let x 2
	let y 5
	let prevX 1
	let prevY 4
	ret
	
:flipxsp
	push -1
	push xsp
	mul
	setpop xsp
	ret
	
:flipysp
	push -1
	push ysp
	mul
	setpop ysp
	ret
	
:move
	let prevX x
	let prevY y

	push xsp
	push x
	add
	setpop x
	
	push ysp
	push y
	add
	setpop y

	push 255
	push i
	inc
	setpop i
	push i

	grt return
	let i 16
	:return
	ret
	
:collision
	push 0
	push x
	lwr endLeft
	
	let x 1
	call flipxsp
	
	:endLeft
	push RIGHT
	push x
	grt endRight
	
	let x RIGHTPOS
	call flipxsp
	
	:endRight
	push 0
	push y
	lwr endUp
	
	let y 1
	call flipysp
	
	:endUp
	push DOWN
	push y
	grt endDown
	
	let y DOWNPOS
	call flipysp
	
	:endDown
	ret
	
:draw
	push x
	push y
	console setpos
	print "0"
	
	push prevX
	push prevY
	console setpos
	print " "
	
	ret
	
:main
	:loop
	call move
	call collision
	call draw
	call sleep
	push i
	console setcolor
	goto loop

:sleep
	let wait 0
	:sleepLoop
	push 500 ;This is not a timer, it just runs this code alot of times
	push wait
	lwr end
	push wait
	inc
	setpop wait
	goto sleepLoop
	:end
	free wait
	ret